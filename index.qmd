---
title: "Obtendo dados do SIDRA/IBGE com R utilizando o pacote SIDRAR"
subtitle: "Tutorial - 69ª RBras e ao 21º SEAGRO"
author: "Beatriz Milz"
format: 
  revealjs:
    logo: "images/rbras-cut.png"
    footer: "[beamilz.com](https://beamilz.com) > talks and teaching > obtendo dados do SIDRA/IBGE com R utilizando o pacote SIDRAR"
    slide-number: c/t
    show-slide-number: all
    code-link: true
    code-copy: true
    scrollable: true
    theme: rbras.scss
---


## Beatriz Milz

-   Doutora em Ciência Ambiental no IEE/USP
-   Atualmente: Estágio pós-doutoral na UFABC
-   Co-organizadora da [R-Ladies São Paulo](https://rladies-sp.org)
-   *Software peer review editor* na [rOpenSci](https://ropensci.org/)
-   [GitHub Star](https://stars.github.com/profiles/beatrizmilz/)

<center>[![](images/logo-rladies.png){fig-align="center"
width="20%"}](https://rladies-sp.org/)
[![](images/ropensci.png){fig-align="center"
width="20%"}](https://ropensci.org/)
[![](images/github-stars-logo_Color.webp){fig-align="center"
width="25%"}](https://stars.github.com/profiles/beatrizmilz/)</center>

##  {background-color="white" background-image="images/linha-do-tempo.jpg" background-size="contain" logo="false"}

::: footer
:::

# O que é o SIDRA?

## Sistema IBGE de Recuperação Automática - SIDRA

> "O Sistema IBGE de Recuperação Automática - SIDRA permite a consulta aos dados armazenados no Banco de Tabelas Estatísticas."

![](images/homepage_sidra.png){fig-align="center" width="100%"}


## Dados disponíveis: PESQUISAS

:::: {.columns}

::: {.column width="40%"}
![](images/sidra-pesquisas-1.png){fig-align="center" width="100%"}
:::

::: {.column width="60%"}
![](images/sidra-pesquisas-2.png){fig-align="center" width="100%"}
:::

::::
 
## Organização em tabelas 

![](images/organizacao-tabelas.png){fig-align="center" width="100%"}
 
## Interface web
É possível consultar dados pela interface web:

[![](images/sidra-web-1.png){fig-align="center" width="100%"}](https://sidra.ibge.gov.br/tabela/2609)

## Interface web

É possível fazer o download da tabela em formatos como `.xlsx` (Excel) e `.ods` (Open Document Spreadsheet):

[![](images/sidra-web-2.png){fig-align="center" width="100%"}](https://sidra.ibge.gov.br/tabela/2609#resultado)


# O que é o `{sidrar}`?

## Pacote `{sidrar}`

O pacote `{sidrar}` é uma ferramenta desenvolvida para facilitar o acesso aos dados do SIDRA/IBGE diretamente no R, permitindo consultas e extração de dados de forma programática.

O pacote está disponível no CRAN:

```{r}
#| eval: false
#| echo: true
install.packages("sidrar")
```

## Introdução ao pacote `{sidrar}`

Carregar o pacote:

```{r}
#| echo: true
library(sidrar)
```

As funções do pacote dependem de uma conexão com a internet, pois acessam a API do SIDRA para obter os dados.


# Funções do pacote `{sidrar}`

Funções disponíveis:

- `search_sidra()`: Pesquisa tabelas disponíveis no SIDRA.

- `info_sidra()`: Obtém informações sobre uma tabela específica.

- `get_sidra()`: Extrai dados de uma tabela específica do SIDRA.


## `search_sidra()`

A função `search_sidra()` permite pesquisar tabelas disponíveis no SIDRA, e descobrir o código da tabela que queremos consultar.

Obs: **eu** prefiro fazer essa busca no próprio site do SIDRA.

## Exemplo de uso da função `search_sidra()`

```{r}
#| echo: true
search_sidra("PNADCT")
```


## `info_sidra()`

A função `info_sidra()` fornece informações sobre uma tabela específica do SIDRA, incluindo descrição, variáveis disponíveis e outras metadados.

O resultado é um objeto do tipo lista. Recomendo salvar o resultado em uma variável para facilitar a consulta posterior.

Lembrete: podemos usar o operador `$` para acessar os elementos da lista.

## Exemplo de uso da função `info_sidra()`

```{r}
#| echo: true
#| cache: true

informacoes <- info_sidra("4092")
names(informacoes)
```

## Acessando informações da lista

```{r}
#| echo: true
informacoes$table
```
## Acessando informações da lista

```{r}
#| echo: true
informacoes$period
```
## Acessando informações da lista

```{r}
#| echo: true
knitr::kable(informacoes$geo)
```


## Acessando informações da lista

```{r}
#| echo: true
knitr::kable(informacoes$variable)
```

## Acessando informações da lista

```{r}
#| echo: true
knitr::kable(informacoes$classific_category)
```


## `get_sidra()`

A função `get_sidra()` é utilizada para extrair dados de uma tabela específica do SIDRA. É possível especificar parâmetros como período, abrangência geográfica e variáveis desejadas.

É possível consultar todos os arqumentos da função na documentação (`?get_sidra`).

## `get_sidra()`

Esses são os principais argumentos da função:

  - `x`: código da tabela do SIDRA (obrigatório).
  - `variable`: vetor (do tipo `integer`) de códigos das variáveis a serem retornadas (padrão: todas, exceto "Total").
  - `period`: vetor (do tipo `character`) descrevendo o período dos dados (padrão: último disponível).
  - `geo`: vetor (do tipo `character`) descrevendo os níveis geográficos dos dados (padrão: "Brasil").
  - `classific`: vetor (do tipo `character`) com classificações da tabela (padrão: todas).
  


## Exemplo de uso da função `get_sidra()`


Se indicarmos apenas o código da tabela, a função retorna dados sumarizados para o Brasil, com todas as variáveis disponíveis, para o último período disponível.

```{r}
#| echo: true
#| cache: true

resultados_sidra <- get_sidra(x = 4092)
```
## Exemplo dos dados retornados

```{r}
#| echo: true
resultados_sidra
```

## Como buscar vários períodos?

Temos a informação dos períodos disponíveis na lista retornada pela função `info_sidra()`, como uma string:

```{r}
#| echo: true
informacoes$period
```

E a função `get_sidra()` aceita um **vetor** de períodos!

## Como buscar vários períodos?

Podemos quebrar a string com os períodos em um vetor usando a função `str_split()` do pacote `{stringr}`:

```{r}
#| echo: true
stringr::str_split(informacoes$period, ", ")
```
## Como buscar vários períodos?

O resultado é uma lista, então precisamos acessar o primeiro elemento da lista (que é um vetor):

```{r}
#| echo: true
stringr::str_split(informacoes$period, ", ")[[1]]
```

Esse é o formato que precisamos!

## Como buscar vários períodos?

Vamos salvar o resultado em uma variável:

```{r}
#| echo: true
periodos <- stringr::str_split(informacoes$period, ", ")[[1]]
```

Com isso, podemos usar o vetor `periodos` como argumento na função `get_sidra()`:

```{r}
#| echo: true
#| eval: false
#| cache: true
resultados_sidra_periodos_uf <- get_sidra(x = 4092,
                                              period = periodos,
                                              geo = c("State"))
```

## Recomendação

Após obter os dados, é interessante salvá-los em um arquivo local para evitar consultas repetidas.

O formato `.rds` é interessante para salvar objetos do R, pois preserva a estrutura dos dados:

```{r}
#| echo: true
#| eval: false
readr::write_rds(x = resultados_sidra_periodos_uf,
                 file = "data-raw/dados_sidra_4092.rds")
```




# Conclusão

## Materiais

- [Script](https://github.com/beatrizmilz/2025-08-rbras-sidrar/blob/main/script.R) e [repositório](https://github.com/beatrizmilz/2025-08-rbras-sidrar/)

- Material do curso ["Introdução à análise de dados no R"](https://ipeadata-lab.github.io/curso_r_intro_202409/03_importacao.html#pacote-sidrar)

![](images/grafico_ipeaplot.png){fig-align="center" width="50%"}

## Contato

- Email: [milz.bea@gmail.com](mailto:milz.bea@gmail.com)

- Página pessoal: [beamilz.com](https://beamilz.com)

- Linkedin: [linkedin.com/in/beatriz-milz](https://www.linkedin.com/in/beatrizmilz/?originalSubdomain=br)

- Instagram: [@bea.milz](https://www.instagram.com/bea.milz/)

- Youtube: [youtube.com/@beamilz](https://www.youtube.com/@beamilz)

<br>
<center>
### Obrigada!
</center>